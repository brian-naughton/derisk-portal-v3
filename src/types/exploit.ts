export interface CIRExplanation {
  title: string;
  summary?: string;
  guidance: {
    investor: string;
    developer: string;
  };
}

export interface RiskFactor {
  score: number;
  description: string;
  full_evidence?: string;
  key?: string;
  explanation_investors?: string;
  explanation_developers?: string;
  cir_explanation?: CIRExplanation;
}

export interface MitigationSignal {
  type: 'positive_signal' | 'floor_adjustment' | 'advisory_signal' | 'actuarial_intelligence' | 'actuarial_detail';
  key: string;
  description?: string;
  name?: string;
  value?: string;
  points_saved?: number;
  points_added?: number;
}

export interface ScanResult {
  Name: string;
  ContractAddress: string;
  RiskScore: number;
  RiskCategory: 'high' | 'medium' | 'low';
  RiskDescription: string;
  RiskFactors: RiskFactor[];
  MitigationsAndSignals: MitigationSignal[];
  ScanDate: string;
  ScanDuration: number;
}

export interface ExploitMeta {
  name: string;
  date: string;
  loss_amount_usd: number;
  attack_vector: string;
  description: string;
  chain: string;
}

export interface ActuarialData {
  pre_actuarial_score: number;
  slider_deltas: number[];
  show_max_risk_message: boolean;
  base: number;
  refined: number;
  delta: number;
  full_delta: number;
  weight: number;
  uplift_pct: number;
  multiplier: number;
}

export interface MultiplierDetail {
  cluster: string;
  added_points: number;
}

export interface NarrativeSection {
  title: string;
  text: string;
}

export interface NarrativeBreakdown {
  vulnerability: string;
  steps: string;
}

export interface Narrative {
  sections: NarrativeSection[];
  breakdown?: NarrativeBreakdown;
}

export interface ExploitData {
  exploit_id: string;
  scan_result: ScanResult;
  exploit_meta: ExploitMeta;
  chain_display_name: string;
  actuarial: ActuarialData;
  composition: {
    raw_risk_score: number;
    mitigation_credit: number;
    multiplier_details: MultiplierDetail[];
  };
  context_data: { archetype?: string };
  primitive_count: number;
  narrative?: Narrative;
}
